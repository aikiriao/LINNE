#include "linne_internal.h"

/* 配列の要素数を取得 */
#define LINNE_NUM_ARRAY_ELEMENTS(array) ((sizeof(array)) / (sizeof(array[0])))
/* プリセットの要素定義 */
#define LINNE_DEFINE_ARRAY_AND_NUM_ELEMTNS_TUPLE(array) LINNE_NUM_ARRAY_ELEMENTS(array), array
/* プリセットの定義 */
#define LINNE_DEFINE_PARAMEETR_PRESET(layer_structure, regular_terms, coef_freq_table) \
    {\
        LINNE_DEFINE_ARRAY_AND_NUM_ELEMTNS_TUPLE(layer_structure),\
        LINNE_DEFINE_ARRAY_AND_NUM_ELEMTNS_TUPLE(regular_terms),\
        LINNE_DEFINE_ARRAY_AND_NUM_ELEMTNS_TUPLE(coef_freq_table),\
    }

/* レイヤーパラメータ配列 */
static const uint32_t layer_structure_preset1[] = {       8,  32 };
static const uint32_t layer_structure_preset2[] = {  4,  64,   8 };
static const uint32_t layer_structure_preset3[] = {  4, 128,  16 };

/* 正則化パラメータ候補配列 */
static const double regular_terms_list1[] = {                                         0.0 };
static const double regular_terms_list2[] = {                            0.0, 1.0 / 512.0 };
static const double regular_terms_list3[] = { 0.0, 1.0 / 2048.0, 1.0 / 512.0, 1.0 / 128.0 };

/* 係数頻度テーブル */
static const uint32_t coef_freq_table[256] = {
    2944693,2417040,2500224,2220717,2361506,2005548,2161319,1804396,1961813,1628891,1774159,1471673,1604885,1335449,1451476,1218111,1316402,1112581,1200154,1019661,1094294,935533,1000598,861453,914647,793863,837607,733372,769686,679634,709504,630828,653277,583990,602876,545068,556612,507071,516014,473301,478009,441389,442848,415057,412045,389010,384623,364872,359578,343600,335976,322541,314173,304513,293388,286871,277191,271905,260699,256892,245269,243815,231142,231894,217938,220197,205798,209146,196061,199652,185811,189659,176121,181265,168122,173827,159699,167156,150968,158868,144276,152666,137117,146329,130245,141026,124044,134984,118946,130389,113141,125287,108826,120399,102664,116857,98953,112210,93718,109059,89757,106036,86363,102597,82554,99558,78306,96473,76105,92575,72428,89227,68911,85952,66258,82764,63571,80241,61196,78050,58502,75544,56329,73454,53557,71750,51667,81769,52853,90325,53934,86990,51338,83565,48756,80882,47304,78156,44823,75050,43129,72304,41339,70163,39767,67853,37538,65134,35572,62994,34367,61059,32981,58664,31690,56196,30505,54354,29091,52803,27750,50577,26523,49428,25414,47359,24109,46224,23419,44925,22167,43578,21336,42201,20551,41434,19640,39842,18815,38775,18200,37804,17159,36516,16591,35217,16053,34221,14962,33101,14533,32077,13842,31550,13427,30277,12962,29616,12296,29090,11678,27922,11467,27212,10733,26329,10270,25938,9930,24828,9336,24672,9085,23868,8616,23456,8430,22633,7892,21759,7594,21723,7430,20729,6988,20475,6673,20100,6489,19480,6100,18993,5912,18480,5599,17993,5292,17267,5100,17013,4919,16502,4721,16304,4471,16040,4313,16120,4090,17146,3921,28239,3817,49638,5544,7587,
};
LINNE_STATIC_ASSERT((1 << LINNE_LPC_COEFFICIENT_BITWIDTH) == LINNE_NUM_ARRAY_ELEMENTS(coef_freq_table));

/* パラメータプリセット配列 */
const struct LINNEParameterPreset g_linne_parameter_preset[LINNE_NUM_PARAMETER_PRESETS] = {
    LINNE_DEFINE_PARAMEETR_PRESET(layer_structure_preset1, regular_terms_list1, coef_freq_table),
    LINNE_DEFINE_PARAMEETR_PRESET(layer_structure_preset1, regular_terms_list2, coef_freq_table),
    LINNE_DEFINE_PARAMEETR_PRESET(layer_structure_preset2, regular_terms_list1, coef_freq_table),
    LINNE_DEFINE_PARAMEETR_PRESET(layer_structure_preset2, regular_terms_list2, coef_freq_table),
    LINNE_DEFINE_PARAMEETR_PRESET(layer_structure_preset2, regular_terms_list3, coef_freq_table),
    LINNE_DEFINE_PARAMEETR_PRESET(layer_structure_preset3, regular_terms_list1, coef_freq_table),
    LINNE_DEFINE_PARAMEETR_PRESET(layer_structure_preset3, regular_terms_list2, coef_freq_table),
    LINNE_DEFINE_PARAMEETR_PRESET(layer_structure_preset3, regular_terms_list3, coef_freq_table),
};

